<!-- This file displays the animated SVG link to the GitHub repository 
in the top right corner -->


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Estimating the potential energy surface of molecular Hydrogen with ZNE &#8212; Mitiq 0.14.0dev documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/styles/pydata-sphinx-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API-doc" href="../apidoc.html" />
    <link rel="prev" title="Mitiq paper codeblocks" href="mitiq-paper/mitiq-paper-codeblocks.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/mitiq-logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../readme.html">
  <a href="https://github.com/unitaryfund/mitiq">
  </a>
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../guide/guide.html">
  Users Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="examples.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../apidoc.html">
  API-doc
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../toc_contributing.html">
  Contributing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../changelog.html">
  Changelog
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../zz_bibliography.html">
  References
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="braket_mirror_circuit.html">
   Mirror circuit benchmark improved with zero-noise extrapolation on AWS Braket
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ibmq-backends.html">
   Zero-noise extrapolation on IBMQ backends
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pyquil_demo.html">
   Zero-noise extrapolation on PyQuil parametric programs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vqe-pyquil-demo.html">
   Variational quantum eigensolver improved with zero-noise extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simple_landscape.html">
   Variational circuit mitigation with zero-noise extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="maxcut-demo.html">
   MaxCut benchmark with zero-noise extrapolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hamiltonians.html">
   Defining a Mitiq executor with a hamiltonian
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mitiq-paper/mitiq-paper-codeblocks.html">
   Mitiq paper codeblocks
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Estimating the potential energy surface of molecular Hydrogen with ZNE
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-hamiltonian-for-rm-h-2">
   The Hamiltonian for
   <span class="math notranslate nohighlight">
    \(\rm H_2\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluating-the-energy-landscape-for-a-fixed-r">
   Evaluating the energy landscape for a fixed
   <span class="math notranslate nohighlight">
    \(R\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-zero-noise-extrapolation-to-estimate-e-theta-r">
     Applying zero-noise extrapolation to estimate
     <span class="math notranslate nohighlight">
      \(E(\theta, R)\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluating-the-potential-energy-surface-v-r">
   Evaluating the potential energy surface
   <span class="math notranslate nohighlight">
    \(V(R)\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-zero-noise-extrapolation-to-estimate-v-r">
     Applying zero-noise extrapolation to estimate
     <span class="math notranslate nohighlight">
      \(V(R)\)
     </span>
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
    
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="estimating-the-potential-energy-surface-of-molecular-hydrogen-with-zne">
<h1>Estimating the potential energy surface of molecular Hydrogen with ZNE<a class="headerlink" href="#estimating-the-potential-energy-surface-of-molecular-hydrogen-with-zne" title="Permalink to this headline">#</a></h1>
<p>In this example we apply zero-noise extrapolation (ZNE) to the estimation of the potential energy surface of molecular Hydrogen (<span class="math notranslate nohighlight">\(\rm H_2\)</span>).
The variational algorithm used in this example is based on <em>Oâ€™Malley et al. PRX (2016)</em> <span id="id1">[<a class="reference internal" href="../zz_bibliography.html#id24" title="P. J. J. O'Malley, R. Babbush, I. D. Kivlichan, J. Romero, J. R. McClean, R. Barends, J. Kelly, P. Roushan, A. Tranter, N. Ding, B. Campbell, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, A. G. Fowler, E. Jeffrey, E. Lucero, A. Megrant, J. Y. Mutus, M. Neeley, C. Neill, C. Quintana, D. Sank, A. Vainsencher, J. Wenner, T. C. White, P. V. Coveney, P. J. Love, H. Neven, A. Aspuru-Guzik, and J. M. Martinis. Scalable quantum simulation of molecular energies. Phys. Rev. X, 6:031007, (2016). URL: https://link.aps.org/doi/10.1103/PhysRevX.6.031007, doi:10.1103/PhysRevX.6.031007.">33</a>]</span>.</p>
<p>With the appropriate settings (see code comments in the ZNE subsection), this notebook reproduces the results
shown in Figure 4 of the Mitiq white paper.</p>
<div class="figure align-default" id="h2-figure">
<a class="reference internal image-reference" href="https://calango.org/images/courses/27/528/3350/lewis-structures-and-covalent-bonding_1.jpg"><img alt="https://calango.org/images/courses/27/528/3350/lewis-structures-and-covalent-bonding_1.jpg" src="https://calango.org/images/courses/27/528/3350/lewis-structures-and-covalent-bonding_1.jpg" style="height: 200px;" /></a>
<p class="caption"><span class="caption-text">Figure 1: Pictorial representation of the <span class="math notranslate nohighlight">\(\rm H_2\)</span> molecule.
Extracted from <a class="reference external" href="https://calango.org/lessons/3350/learn/lewis-structures-and-covalent-bonding/">calango.org</a>.
In this example, we variationally estimate the potential energy surface of the molecule as a function of the bond length <span class="math notranslate nohighlight">\(R\)</span>.</span><a class="headerlink" href="#h2-figure" title="Permalink to this image">#</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">brute</span>
<span class="kn">import</span> <span class="nn">cirq</span>

<span class="kn">from</span> <span class="nn">mitiq</span> <span class="kn">import</span> <span class="n">zne</span>  <span class="c1"># Zero-noise extrapolation module</span>
<span class="kn">from</span> <span class="nn">mitiq.interface.mitiq_cirq</span> <span class="kn">import</span> <span class="n">compute_density_matrix</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-hamiltonian-for-rm-h-2">
<h2>The Hamiltonian for <span class="math notranslate nohighlight">\(\rm H_2\)</span><a class="headerlink" href="#the-hamiltonian-for-rm-h-2" title="Permalink to this headline">#</a></h2>
<p>We can write down the Hamiltonian for <span class="math notranslate nohighlight">\(\rm H_2\)</span> in the following form <span id="id2">[<a class="reference internal" href="../zz_bibliography.html#id24" title="P. J. J. O'Malley, R. Babbush, I. D. Kivlichan, J. Romero, J. R. McClean, R. Barends, J. Kelly, P. Roushan, A. Tranter, N. Ding, B. Campbell, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, A. G. Fowler, E. Jeffrey, E. Lucero, A. Megrant, J. Y. Mutus, M. Neeley, C. Neill, C. Quintana, D. Sank, A. Vainsencher, J. Wenner, T. C. White, P. V. Coveney, P. J. Love, H. Neven, A. Aspuru-Guzik, and J. M. Martinis. Scalable quantum simulation of molecular energies. Phys. Rev. X, 6:031007, (2016). URL: https://link.aps.org/doi/10.1103/PhysRevX.6.031007, doi:10.1103/PhysRevX.6.031007.">33</a>]</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-4fc2231c-17e9-4d57-82c9-956556b72946">
<span class="eqno">(1)<a class="headerlink" href="#equation-4fc2231c-17e9-4d57-82c9-956556b72946" title="Permalink to this equation">#</a></span>\[\begin{equation}
    H = g_0 I + g_1 Z_0 + g_2 Z_1 + g_3 Z_0 Z_1 + g_4 X_0 X_1 + g_5 Y_0 Y_1
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(g_i\)</span> are numerical values that depend on the bond length <span class="math notranslate nohighlight">\(R\)</span>. The above Hamiltonian:</p>
<ol class="simple">
<li><p>Uses the minimal <a class="reference external" href="https://en.wikipedia.org/wiki/STO-nG_basis_sets">STO-6G basis</a>,</p></li>
<li><p>Uses the Bravyi-Kitaev transform, and</p></li>
<li><p>Reduces resources (qubit number) by symmetry considerations (see <span id="id3">[<a class="reference internal" href="../zz_bibliography.html#id24" title="P. J. J. O'Malley, R. Babbush, I. D. Kivlichan, J. Romero, J. R. McClean, R. Barends, J. Kelly, P. Roushan, A. Tranter, N. Ding, B. Campbell, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, A. G. Fowler, E. Jeffrey, E. Lucero, A. Megrant, J. Y. Mutus, M. Neeley, C. Neill, C. Quintana, D. Sank, A. Vainsencher, J. Wenner, T. C. White, P. V. Coveney, P. J. Love, H. Neven, A. Aspuru-Guzik, and J. M. Martinis. Scalable quantum simulation of molecular energies. Phys. Rev. X, 6:031007, (2016). URL: https://link.aps.org/doi/10.1103/PhysRevX.6.031007, doi:10.1103/PhysRevX.6.031007.">33</a>]</span> for more details).</p></li>
</ol>
<p>Each coefficient <span class="math notranslate nohighlight">\(g_i\)</span> is a function of the bond length <span class="math notranslate nohighlight">\(g_i = g_i(R)\)</span>.
Their values are specified in the table below, extracted from Table 1 of Appendix C of <span id="id4">[<a class="reference internal" href="../zz_bibliography.html#id24" title="P. J. J. O'Malley, R. Babbush, I. D. Kivlichan, J. Romero, J. R. McClean, R. Barends, J. Kelly, P. Roushan, A. Tranter, N. Ding, B. Campbell, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, A. G. Fowler, E. Jeffrey, E. Lucero, A. Megrant, J. Y. Mutus, M. Neeley, C. Neill, C. Quintana, D. Sank, A. Vainsencher, J. Wenner, T. C. White, P. V. Coveney, P. J. Love, H. Neven, A. Aspuru-Guzik, and J. M. Martinis. Scalable quantum simulation of molecular energies. Phys. Rev. X, 6:031007, (2016). URL: https://link.aps.org/doi/10.1103/PhysRevX.6.031007, doi:10.1103/PhysRevX.6.031007.">33</a>]</span>, in which the first column corresponds to the bond length <span class="math notranslate nohighlight">\(R\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data is organized as follow</span>
<span class="c1">#   |   R   |   g0   |   g1   |   g2   |    g3  |   g4   |   g5   |</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span> <span class="mf">0.2</span>   <span class="p">,</span>  <span class="mf">2.8489</span><span class="p">,</span>  <span class="mf">0.5678</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4508</span><span class="p">,</span>  <span class="mf">0.6799</span><span class="p">,</span>  <span class="mf">0.0791</span><span class="p">,</span>  <span class="mf">0.0791</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">0.4</span>   <span class="p">,</span>  <span class="mf">1.1182</span><span class="p">,</span>  <span class="mf">0.4754</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9145</span><span class="p">,</span>  <span class="mf">0.6438</span><span class="p">,</span>  <span class="mf">0.0825</span><span class="p">,</span>  <span class="mf">0.0825</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">0.6</span>   <span class="p">,</span>  <span class="mf">0.4808</span><span class="p">,</span>  <span class="mf">0.3937</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.595</span> <span class="p">,</span>  <span class="mf">0.6025</span><span class="p">,</span>  <span class="mf">0.087</span> <span class="p">,</span>  <span class="mf">0.087</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mf">0.8</span>   <span class="p">,</span>  <span class="mf">0.1626</span><span class="p">,</span>  <span class="mf">0.3288</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3915</span><span class="p">,</span>  <span class="mf">0.5616</span><span class="p">,</span>  <span class="mf">0.0925</span><span class="p">,</span>  <span class="mf">0.0925</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">1.0</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.0172</span><span class="p">,</span>  <span class="mf">0.2779</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.255</span> <span class="p">,</span>  <span class="mf">0.5235</span><span class="p">,</span>  <span class="mf">0.0986</span><span class="p">,</span>  <span class="mf">0.0986</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">1.2</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.1253</span><span class="p">,</span>  <span class="mf">0.2374</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1603</span><span class="p">,</span>  <span class="mf">0.4892</span><span class="p">,</span>  <span class="mf">0.105</span> <span class="p">,</span>  <span class="mf">0.105</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mf">1.4</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.1927</span><span class="p">,</span>  <span class="mf">0.2048</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0929</span><span class="p">,</span>  <span class="mf">0.4588</span><span class="p">,</span>  <span class="mf">0.1116</span><span class="p">,</span>  <span class="mf">0.1116</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">1.6</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.2355</span><span class="p">,</span>  <span class="mf">0.1782</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0442</span><span class="p">,</span>  <span class="mf">0.4323</span><span class="p">,</span>  <span class="mf">0.1181</span><span class="p">,</span>  <span class="mf">0.1181</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">1.8</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.2632</span><span class="p">,</span>  <span class="mf">0.1565</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0088</span><span class="p">,</span>  <span class="mf">0.4094</span><span class="p">,</span>  <span class="mf">0.1241</span><span class="p">,</span>  <span class="mf">0.1241</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">2.0</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.2812</span><span class="p">,</span>  <span class="mf">0.139</span> <span class="p">,</span>  <span class="mf">0.0171</span><span class="p">,</span>  <span class="mf">0.3898</span><span class="p">,</span>  <span class="mf">0.1297</span><span class="p">,</span>  <span class="mf">0.1297</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">2.2</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.2934</span><span class="p">,</span>  <span class="mf">0.1251</span><span class="p">,</span>  <span class="mf">0.0359</span><span class="p">,</span>  <span class="mf">0.373</span> <span class="p">,</span>  <span class="mf">0.1347</span><span class="p">,</span>  <span class="mf">0.1347</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">2.4</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.3018</span><span class="p">,</span>  <span class="mf">0.1142</span><span class="p">,</span>  <span class="mf">0.0495</span><span class="p">,</span>  <span class="mf">0.3586</span><span class="p">,</span>  <span class="mf">0.1392</span><span class="p">,</span>  <span class="mf">0.1392</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">2.6</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.3079</span><span class="p">,</span>  <span class="mf">0.1059</span><span class="p">,</span>  <span class="mf">0.0594</span><span class="p">,</span>  <span class="mf">0.3461</span><span class="p">,</span>  <span class="mf">0.1432</span><span class="p">,</span>  <span class="mf">0.1432</span><span class="p">],</span>
<span class="p">])</span>

<span class="c1"># Grab the radius R and the g_j coefficients</span>
<span class="n">radii</span> <span class="o">=</span> <span class="n">table</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">table</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<p>We define a function that evaluates the expectation value of the Hamiltonian on a noisy backend and for a given input circuit (ansatz).
Here we use a Cirq density matrix simulator with a simple depolarizing noise model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">energy</span><span class="p">(</span>
    <span class="n">ansatz</span><span class="p">:</span> <span class="n">cirq</span><span class="o">.</span><span class="n">Circuit</span><span class="p">,</span> <span class="n">radius_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">depo_noise_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Computes the energy at a given bond length (radius).&quot;&quot;&quot;</span>
    <span class="n">npI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">npX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
    <span class="n">npY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
    <span class="n">npZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]])</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">coeffs</span><span class="p">[</span><span class="n">radius_index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">npI</span><span class="p">,</span> <span class="n">npI</span><span class="p">),</span>
        <span class="n">coeffs</span><span class="p">[</span><span class="n">radius_index</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">npZ</span><span class="p">,</span> <span class="n">npI</span><span class="p">),</span>
        <span class="n">coeffs</span><span class="p">[</span><span class="n">radius_index</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">npI</span><span class="p">,</span> <span class="n">npZ</span><span class="p">),</span>
        <span class="n">coeffs</span><span class="p">[</span><span class="n">radius_index</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">npZ</span><span class="p">,</span> <span class="n">npZ</span><span class="p">),</span>
        <span class="n">coeffs</span><span class="p">[</span><span class="n">radius_index</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">npX</span><span class="p">,</span> <span class="n">npX</span><span class="p">),</span>
        <span class="n">coeffs</span><span class="p">[</span><span class="n">radius_index</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">npY</span><span class="p">,</span> <span class="n">npY</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">hamiltonian</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">compute_density_matrix</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">cirq</span><span class="o">.</span><span class="n">depolarize</span><span class="p">,</span> <span class="p">(</span><span class="n">depo_noise_strength</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">hamiltonian</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluating-the-energy-landscape-for-a-fixed-r">
<h2>Evaluating the energy landscape for a fixed <span class="math notranslate nohighlight">\(R\)</span><a class="headerlink" href="#evaluating-the-energy-landscape-for-a-fixed-r" title="Permalink to this headline">#</a></h2>
<p>We first define a function that returns single-parameter variational circuit. The ansatz is based on on Fig. 1 of <span id="id5">[<a class="reference internal" href="../zz_bibliography.html#id24" title="P. J. J. O'Malley, R. Babbush, I. D. Kivlichan, J. Romero, J. R. McClean, R. Barends, J. Kelly, P. Roushan, A. Tranter, N. Ding, B. Campbell, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, A. G. Fowler, E. Jeffrey, E. Lucero, A. Megrant, J. Y. Mutus, M. Neeley, C. Neill, C. Quintana, D. Sank, A. Vainsencher, J. Wenner, T. C. White, P. V. Coveney, P. J. Love, H. Neven, A. Aspuru-Guzik, and J. M. Martinis. Scalable quantum simulation of molecular energies. Phys. Rev. X, 6:031007, (2016). URL: https://link.aps.org/doi/10.1103/PhysRevX.6.031007, doi:10.1103/PhysRevX.6.031007.">33</a>]</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ansatz</span><span class="p">(</span><span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cirq</span><span class="o">.</span><span class="n">Circuit</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the circuit associated to the input variational parameter.&quot;&quot;&quot;</span>
    <span class="n">qreg</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cirq</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span>
        <span class="n">cirq</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qreg</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">cirq</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qreg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">cirq</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qreg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">cirq</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">CNOT</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="o">*</span><span class="n">qreg</span><span class="p">),</span>
        <span class="n">cirq</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qreg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">cirq</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">CNOT</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="o">*</span><span class="n">qreg</span><span class="p">),</span>
        <span class="n">cirq</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qreg</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">cirq</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qreg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Below we set a particular radius <span class="math notranslate nohighlight">\(R\)</span> and sweep the <span class="math notranslate nohighlight">\(\theta\)</span> parameter to evaluate the unmitigated energy landscape <span class="math notranslate nohighlight">\(E(\theta, R)\)</span>
using different strengths <span class="math notranslate nohighlight">\(p\)</span> of depolarizing noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Noise levels</span>
<span class="n">pvals</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="c1"># Variational parameters</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">all_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">pvals</span><span class="p">:</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">:</span>
        <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">ansatz</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">radius_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">depo_noise_strength</span><span class="o">=</span><span class="n">pval</span><span class="p">))</span>
    <span class="n">all_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energies</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The unmitigated energy landscapes are now stored in the <code class="docutils literal notranslate"><span class="pre">all_energies</span></code> variable and will be visualized
later.</p>
<div class="section" id="applying-zero-noise-extrapolation-to-estimate-e-theta-r">
<h3>Applying zero-noise extrapolation to estimate <span class="math notranslate nohighlight">\(E(\theta, R)\)</span><a class="headerlink" href="#applying-zero-noise-extrapolation-to-estimate-e-theta-r" title="Permalink to this headline">#</a></h3>
<p>We now use zero-noise extrapolation to error-mitigate the energy landscapes <span class="math notranslate nohighlight">\(E(\theta, R)\)</span> for a fixed
value of <span class="math notranslate nohighlight">\(R\)</span> and for different levels of the noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set noise scaling method</span>
<span class="n">scaling_function</span> <span class="o">=</span> <span class="n">zne</span><span class="o">.</span><span class="n">scaling</span><span class="o">.</span><span class="n">fold_global</span>
<span class="c1"># Set extrapolation method</span>
<span class="n">fac</span> <span class="o">=</span> <span class="n">zne</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">RichardsonFactory</span><span class="p">(</span><span class="n">scale_factors</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="c1"># Set number of trials per expectation value</span>
<span class="n">num_to_average</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># To reproduce the results of the Mitiq paper use the following settings</span>
<span class="c1"># scaling_function = zne.scaling.fold_gates_at_random</span>
<span class="c1"># pfac = zne.inference.PolyFactory(order=3, scale_factors=[1., 1.5, 2., 2.5, 3., 3.5, 4., 4.5, 5., 5.5, 6.])</span>
<span class="c1"># num_to_average = 5</span>
<span class="c1"># pvals = (0.00, 0.02, 0.04, 0.06)</span>
<span class="c1"># thetas = np.linspace(0.0, 2.0 * np.pi, 20)</span>

<span class="n">all_mitigated</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pvals</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">mitigated</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">:</span>
        <span class="c1"># Define an executor function</span>
        <span class="n">execute</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">radius_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">depo_noise_strength</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
        <span class="c1"># Run ZNE</span>
        <span class="n">zne_value</span> <span class="o">=</span> <span class="n">zne</span><span class="o">.</span><span class="n">execute_with_zne</span><span class="p">(</span>
            <span class="n">ansatz</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
            <span class="n">execute</span><span class="p">,</span>
            <span class="n">factory</span><span class="o">=</span><span class="n">fac</span><span class="p">,</span>
            <span class="n">scale_noise</span><span class="o">=</span><span class="n">scaling_function</span><span class="p">,</span>
            <span class="n">num_to_average</span><span class="o">=</span><span class="n">num_to_average</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">mitigated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zne_value</span><span class="p">)</span>
    <span class="n">all_mitigated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mitigated</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the next figure we visualize the following results:</p>
<ol class="simple">
<li><p>The ideal noiseless energy landscape <span class="math notranslate nohighlight">\(E(\theta, R)\)</span> corresponding to <code class="docutils literal notranslate"><span class="pre">all_energies[0]</span></code>;</p></li>
<li><p>The noisy (unmitigated) energies <code class="docutils literal notranslate"><span class="pre">all_energies</span></code>;</p></li>
<li><p>The corresponding error-mitigated energies <code class="docutils literal notranslate"><span class="pre">all_mitigated</span></code>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;font.family&quot;</span><span class="p">:</span> <span class="s2">&quot;serif&quot;</span><span class="p">,</span> <span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;font.weight&quot;</span><span class="p">:</span> <span class="s2">&quot;bold&quot;</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># Plot unmitigated results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Unmitigated&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_energies</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">thetas</span><span class="p">,</span>
        <span class="n">all_energies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="s2">&quot;--s&quot;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$p = </span><span class="si">{</span><span class="n">pvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$E(\theta)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mitigated with ZNE&quot;</span><span class="p">)</span>
<span class="c1"># Plot noiseless results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">thetas</span><span class="p">,</span>
    <span class="n">all_energies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;--s&quot;</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$p = 0.0$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Plot error-mitigated results</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_mitigated</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">thetas</span><span class="p">,</span>
        <span class="n">all_mitigated</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="s2">&quot;--o&quot;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$p = </span><span class="si">{</span><span class="n">pvals</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/molecular_hydrogen_17_0.png" src="../_images/molecular_hydrogen_17_0.png" />
</div>
</div>
<p>In the figure above, the error-mitigated energy landscapes (colored circles) are closer to the ideal noiseless limit
(blue squares) when compared to the unmitigated values (colored squares).</p>
</div>
</div>
<div class="section" id="evaluating-the-potential-energy-surface-v-r">
<h2>Evaluating the potential energy surface <span class="math notranslate nohighlight">\(V(R)\)</span><a class="headerlink" href="#evaluating-the-potential-energy-surface-v-r" title="Permalink to this headline">#</a></h2>
<p>In the previous section we mitigated the energy landscape <span class="math notranslate nohighlight">\(E(\theta, R)\)</span> for a particular value of <span class="math notranslate nohighlight">\(R\)</span>.
Here instead we evaluate the potential energy surface, which can be defined as</p>
<div class="math notranslate nohighlight">
\[V(R) = \min_\theta(E(\theta, R)). \]</div>
<p>We first evaluate <span class="math notranslate nohighlight">\(V(R)\)</span> without using error mitigation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_thetas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">best_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">pvals</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Status: p = </span><span class="si">{</span><span class="n">pval</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">these_thetas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">these_energies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">radii</span><span class="p">)):</span>
        <span class="c1"># Objective function to minimize</span>
        <span class="k">def</span> <span class="nf">obj</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">energy</span><span class="p">(</span><span class="n">ansatz</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">radius_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">depo_noise_strength</span><span class="o">=</span><span class="n">pval</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">brute</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)],</span> <span class="n">Ns</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">finish</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">these_thetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">these_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">best_thetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">these_thetas</span><span class="p">)</span>
    <span class="n">best_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">these_energies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Status: p = 0.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Status: p = 0.02
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Status: p = 0.04
</pre></div>
</div>
</div>
</div>
<p>The unmitigated potential energy surfaces are now stored in the <code class="docutils literal notranslate"><span class="pre">best_energies</span></code> variable and will be visualized later.</p>
<div class="section" id="applying-zero-noise-extrapolation-to-estimate-v-r">
<h3>Applying zero-noise extrapolation to estimate <span class="math notranslate nohighlight">\(V(R)\)</span><a class="headerlink" href="#applying-zero-noise-extrapolation-to-estimate-v-r" title="Permalink to this headline">#</a></h3>
<p>We use zero-noise extrapolation to error-mitigate the potential energy surface <span class="math notranslate nohighlight">\(V(R)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_mitigated_thetas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">best_mitigated_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">pvals</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Status: p = </span><span class="si">{</span><span class="n">pval</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">these_thetas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">these_energies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">radii</span><span class="p">)):</span>

        <span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">zne</span><span class="o">.</span><span class="n">execute_with_zne</span><span class="p">(</span>
                <span class="n">ansatz</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
                <span class="n">partial</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">radius_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">depo_noise_strength</span><span class="o">=</span><span class="n">pval</span><span class="p">),</span>
                <span class="n">factory</span><span class="o">=</span><span class="n">fac</span><span class="p">,</span>
                <span class="n">scale_noise</span><span class="o">=</span><span class="n">scaling_function</span><span class="p">,</span>
                <span class="n">num_to_average</span><span class="o">=</span><span class="n">num_to_average</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Minimize energy with respect to &quot;theta&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">brute</span><span class="p">(</span>
            <span class="n">objective_function</span><span class="p">,</span>
            <span class="n">ranges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)],</span>
            <span class="n">Ns</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">finish</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">these_thetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">these_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">best_mitigated_thetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">these_thetas</span><span class="p">)</span>
    <span class="n">best_mitigated_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">these_energies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Status: p = 0.02
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Status: p = 0.04
</pre></div>
</div>
</div>
</div>
<p>In the next figure we visualize the following results:</p>
<ol class="simple">
<li><p>The ideal noiseless potential energy surface <span class="math notranslate nohighlight">\(V(R)\)</span> corresponding to <code class="docutils literal notranslate"><span class="pre">best_energies[0]</span></code>;</p></li>
<li><p>The noisy (unmitigated) potential energy surfaces <code class="docutils literal notranslate"><span class="pre">best_energies</span></code>;</p></li>
<li><p>The corresponding error-mitigated potential energy surfaces <code class="docutils literal notranslate"><span class="pre">best_mitigated_energies</span></code>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># Plot unmitigated results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Unmitigated&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">pval</span><span class="p">,</span> <span class="n">opt_energies</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pvals</span><span class="p">,</span> <span class="n">best_energies</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">radii</span><span class="p">,</span>
        <span class="n">opt_energies</span><span class="p">,</span>
        <span class="s2">&quot;--s&quot;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$p = </span><span class="si">{</span><span class="n">pval</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span>
    <span class="nb">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">best_energies</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">best_mitigated_energies</span><span class="p">)])</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="nb">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">best_energies</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">best_mitigated_energies</span><span class="p">)])</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Atomic distance (Angstroms)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (Hartree)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="c1"># Plot noiseless results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mitigated with ZNE&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">radii</span><span class="p">,</span>
    <span class="n">best_energies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;-s&quot;</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$p = 0.0$&quot;</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Plot error-mitigated results</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">pval</span><span class="p">,</span> <span class="n">opt_energies</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pvals</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">best_mitigated_energies</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">radii</span><span class="p">,</span>
        <span class="n">opt_energies</span><span class="p">,</span>
        <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$p = </span><span class="si">{</span><span class="n">pval</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span>
    <span class="nb">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">best_energies</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">best_mitigated_energies</span><span class="p">)])</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="nb">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">best_energies</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">best_mitigated_energies</span><span class="p">)])</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Atomic distance (Angstroms)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/molecular_hydrogen_26_0.png" src="../_images/molecular_hydrogen_26_0.png" />
</div>
</div>
<p>In the figure above, the error-mitigated potential energy surfaces (colored circles) are closer to the ideal noiseless limit (blue squares)
when compared to the unmitigated results (colored squares).</p>
</div>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="mitiq-paper/mitiq-paper-codeblocks.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mitiq paper codeblocks</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../apidoc.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API-doc</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          
    
<!--
    Adds link to GitHub repository as an animated SVG in the top-right corner
    of the documentation.
    
    Source: github-corners https://github.com/tholman/github-corners

    License:
    The MIT License (MIT)

    Copyright (c) 2016 Tim Holman

    Permission is hereby granted, free of charge, to any person obtaining a
    copy of this software and associated documentation files (the "Software"),
    to deal in the Software without restriction, including without limitation 
    the rights to use, copy, modify, merge, publish, distribute, sublicense, 
    and/or sell copies of the Software, and to permit persons to whom the 
    Software is furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included in 
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE 
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
    DEALINGS IN THE SOFTWARE.
-->
<a href="https://github.com/unitaryfund/mitiq" class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 60; border: 0; right: 0;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>



      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020, Tech Team @ Unitary Fund.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>